generator client {
  provider      = "prisma-client-js"
  binaryTargets = ["native", "linux-musl-openssl-3.0.x"]
}

datasource db {
  provider = "postgresql"
  url      = env("DATABASE_URL")
}

model anunciantes {
  id                   Int                    @id(map: "lojas_pkey") @default(autoincrement())
  nome                 String                 @db.VarChar(255)
  tipo                 String                 @default("Padrão") @db.VarChar(50)
  descricao            String?
  cnpj                 String?                @db.VarChar(14)
  telefone             String?                @db.VarChar(20)
  email                String?                @db.VarChar(255)
  endereco             String?                @db.VarChar(255)
  cidade               String                 @db.VarChar(100)
  estado               String                 @db.VarChar(2)
  cep                  String?                @db.VarChar(8)
  site                 String?                @db.VarChar(255)
  instagram            String?                @db.VarChar(255)
  facebook             String?                @db.VarChar(255)
  whatsapp             String?                @db.VarChar(20)
  fotoUrl              String?                @db.VarChar(500)
  status               String                 @default("Ativo") @db.VarChar(50) // Ativo ou Desativado
  temAgenda            Boolean                @default(false) // Se sim, mostra o botão de agenda nos anuncios
  dataCriacao          DateTime               @default(now())
  dataAtualizacao      DateTime
  anuncios             anuncios[]
  movimentos_estoque   movimentos_estoque[]
  produtos_em_estoque  produtos_em_estoque[]
  usuarios_anunciantes usuarios_anunciantes[]
  equipes_de_venda     equipes_de_venda[]
  grupos_produtos      grupos_produtos[]
  wishlist_permissoes  listas_desejos_permissoes[]
  agendas              agendas[]
  eventos_agenda       eventos_agenda_anunciante[]
  filas_espera         filas_espera_agenda[] @relation("filas_espera_anunciante")
  links_externos       links_produtos_externos[]
  conversas            conversas[]
  mensagens            mensagens[]
  localidades          anunciantes_x_localidades[]
}

model anuncios {
  id                  Int                     @id @default(autoincrement())
  usuarioId           Int
  anuncianteId        Int
  titulo              String                  @db.VarChar(255)
  descricao           String
  preco               Decimal?                @db.Decimal(10, 2)
  categoria           String?                 @db.VarChar(100)
  imagem              String?                 @db.VarChar(500)
  link                String?                 @db.VarChar(500)
  status              String                  @default("ativo") @db.VarChar(50)
  tipo                String                  @default("produto") @db.VarChar(50)
  isDoacao            Boolean                 @default(false) @map("isdoacao")
  aCombinar           Boolean                 @default(false)
  diasRestantes       Int?
  statusPagamento     String?                 @default("pendente") @db.VarChar(50)
  dataCriacao         DateTime                @default(now())
  dataAtualizacao     DateTime
  cidade              String?                 @db.VarChar(100)
  estado              String?                 @db.VarChar(2)
  visualizacoes       Int                     @default(0)
  destaque            Boolean                 @default(false)
  ordem               Int                     @default(10)  // Admin can customize, default 10, sorted ascending + id descending
  isActive            Boolean                 @default(true)
  anunciantes         anunciantes             @relation(fields: [anuncianteId], references: [id], onDelete: Cascade, map: "anuncios_lojaId_fkey")
  anuncioVisualizados anuncioVisualizados[]
  fotos               fotos_anuncio[]
  wishlists_itens     listas_desejos_itens[]
  agendas             agendas[]
  conversas           conversas[]
  pagamento           pagamentos?
}

// Anuncio Visualizacoes - Log table to track ad views
model anuncioVisualizados {
  id              Int       @id @default(autoincrement())
  anuncioId       Int
  usuarioId       Int?      // Nullable for anonymous/non-logged-in visitors
  dataCriacao     DateTime  @default(now())
  anuncio         anuncios  @relation(fields: [anuncioId], references: [id], onDelete: Cascade)
  usuario         usracessos? @relation(fields: [usuarioId], references: [id], onDelete: SetNull)

  @@index([anuncioId])
  @@index([usuarioId])
  @@index([dataCriacao])
}

model fotos_grupos {
  id          Int      @id @default(autoincrement())
  grupoId     Int
  url         String   @db.VarChar(500)
  ordem       Int?     @default(1)
  dataCriacao DateTime @default(now())
}

model grupos_produtos {
  id              Int      @id @default(autoincrement())
  usuarioId       Int?
  anuncianteId    Int
  nome            String   @db.VarChar(255)
  descricao       String?
  icone           String?  @db.VarChar(50)
  dataCriacao     DateTime @default(now())
  dataAtualizacao DateTime @default(now())
  usuario         usracessos? @relation(fields: [usuarioId], references: [id], onDelete: Cascade)
  anunciante      anunciantes @relation(fields: [anuncianteId], references: [id], onDelete: Cascade)
  productos       productos[]

  @@unique([usuarioId, anuncianteId, nome])
}

model movimentos_estoque {
  id                  Int                 @id @default(autoincrement())
  anuncianteId        Int
  productId           Int
  tipo                String              @db.VarChar(255)
  quantidade          Int
  motivoSaida         String?             @db.VarChar(255)
  observacoes         String?
  dataCriacao         DateTime            @default(now())
  anunciantes         anunciantes         @relation(fields: [anuncianteId], references: [id], onDelete: Cascade, map: "movimentos_estoque_lojaId_fkey")
  produtos_em_estoque produtos_em_estoque @relation(fields: [anuncianteId, productId], references: [anuncianteId, productId], onDelete: Cascade, map: "movimentos_estoque_lojaId_productId_fkey")
  productos           productos           @relation(fields: [productId], references: [id], onDelete: Cascade)
}

model productos {
  id                  Int                   @id @default(autoincrement())
  lojaId              Int
  grupoId             Int
  nome                String                @db.VarChar(255)
  descricao           String?
  sku                 String?               @db.VarChar(100)
  tipo                String                @default("produto") @db.VarChar(50)
  dataCriacao         DateTime              @default(now())
  dataAtualizacao     DateTime
  grupo               grupos_produtos       @relation(fields: [grupoId], references: [id], onDelete: Cascade)
  movimentos_estoque  movimentos_estoque[]
  produtos_em_estoque produtos_em_estoque[]
  links_externos      links_produtos_externos[]
}

model productos_visualizacoes {
  id               Int      @id @default(autoincrement())
  usuarioId        Int?
  productId        Int
  dataVisualizacao DateTime @default(now())
}

model produtos_em_estoque {
  id                 Int                  @id @default(autoincrement())
  anuncianteId       Int
  productId          Int
  quantidade         Int                  @default(0)
  quantidadeMinima   Int?                 @default(0)
  quantidadeMaxima   Int?
  dataCriacao        DateTime             @default(now())
  dataAtualizacao    DateTime
  movimentos_estoque movimentos_estoque[]
  anunciantes        anunciantes          @relation(fields: [anuncianteId], references: [id], onDelete: Cascade, map: "produtos_em_estoque_lojaId_fkey")
  productos          productos            @relation(fields: [productId], references: [id], onDelete: Cascade)

  @@unique([anuncianteId, productId], map: "produtos_em_estoque_lojaId_productId_key")
}

model qrcodes {
  id              Int      @id @default(autoincrement())
  lojaId          Int
  productId       Int
  codigo          String   @unique @db.VarChar(255)
  localizacao     String?  @db.VarChar(255)
  ativo           Boolean  @default(true)
  dataCriacao     DateTime @default(now())
  dataAtualizacao DateTime

  @@unique([lojaId, productId])
}

model qrcodes_chamadas {
  id          Int      @id @default(autoincrement())
  qrcodeId    Int
  dataChamada DateTime @default(now())
}

model tabelas_preco {
  id              Int      @id @default(autoincrement())
  productId       Int
  lojaId          Int
  tamanho         String?  @db.VarChar(50)
  cor             String?  @db.VarChar(50)
  preco           Decimal  @db.Decimal(10, 2)
  dataCriacao     DateTime @default(now())
  dataAtualizacao DateTime

  @@unique([productId, lojaId, tamanho, cor])
}

model usracessos {
  id                    Int                    @id @default(autoincrement())
  nome                  String                 @db.VarChar(255)
  email                 String                 @unique @db.VarChar(255)
  senha                 String                 @db.VarChar(255)
  cpf                   String?                @db.VarChar(14) @unique
  telefone              String?                @db.VarChar(20)
  whatsapp              String?                @db.VarChar(20)
  linkedin              String?                @db.VarChar(255)
  facebook              String?                @db.VarChar(255)
  tipoUsuario           String                 @default("common") @db.VarChar(20)
  tassinatura           String                 @default("Gratuito") @db.VarChar(20)
  dataCriacao           DateTime               @default(now())
  dataAtualizacao       DateTime               @updatedAt
  endereco              String?
  dataVigenciaContrato  DateTime               @default(now())
  numeroAnunciosAtivos  Int                    @default(0)
  maxAnunciosAtivos     Int                    @default(10)
  localidadePadraoId    Int?                   // Default locality for filtering ads
  usuarios_anunciantes  usuarios_anunciantes[]
  membros_equipe        membros_equipe[]
  passwordResetTokens   passwordResetToken[]
  anuncioVisualizados   anuncioVisualizados[]
  fotos_anuncio         fotos_anuncio[]
  grupos_produtos       grupos_produtos[]
  listas_desejos        listas_desejos[]
  reservas_agenda       reservas_agenda[]
  lista_espera_agenda   lista_espera_agenda[]
  filas_espera          filas_espera_agenda[] @relation("fila_espera_usuario")
  eventos_permissoes    eventos_agenda_permissoes[]
  reservas_evento       reservas_evento_agenda[]
  conversas             conversas[]
  mensagens             mensagens[]
  localidadePadrao      localidades?          @relation(fields: [localidadePadraoId], references: [id], onDelete: SetNull)
}

model passwordResetToken {
  id        Int       @id @default(autoincrement())
  usuarioId Int
  token     String    @unique @db.VarChar(500)
  expiresAt DateTime
  createdAt DateTime  @default(now())
  usuario   usracessos @relation(fields: [usuarioId], references: [id], onDelete: Cascade)

  @@index([usuarioId])
}

model usuarios_anunciantes {
  id           Int         @id(map: "usuarios_lojas_pkey") @default(autoincrement())
  usuarioId    Int
  anuncianteId Int
  papel        String      @default("attendant") @db.VarChar(50)
  dataCriacao  DateTime    @default(now())
  anunciantes  anunciantes @relation(fields: [anuncianteId], references: [id], onDelete: Cascade, map: "usuarios_lojas_lojaId_fkey")
  usuario      usracessos  @relation(fields: [usuarioId], references: [id], onDelete: Cascade, map: "usuarios_lojas_usuarioId_fkey")

  @@unique([usuarioId, anuncianteId], map: "usuarios_lojas_usuarioId_lojaId_key")
}

// Equipes de Venda (Sales Teams)
model equipes_de_venda {
  id              Int               @id @default(autoincrement())
  anuncianteId    Int
  nome            String            @db.VarChar(255)
  descricao       String?           @db.Text
  isActive        Boolean           @default(true)
  dataCriacao     DateTime          @default(now())
  dataAtualizacao DateTime          @updatedAt
  anunciantes     anunciantes       @relation(fields: [anuncianteId], references: [id], onDelete: Cascade)
  membros_equipe  membros_equipe[]

  @@map("equipes_de_venda")
}

// Membros da Equipe de Venda (Sales Team Members)
model membros_equipe {
  id              Int                @id @default(autoincrement())
  equipeId        Int
  usuarioId       Int
  nomeMembro      String             @db.VarChar(255)
  email           String             @db.VarChar(255)
  whatsapp        String?            @db.VarChar(20)
  status          String             @default("disponivel")
  dataCriacao     DateTime           @default(now())
  dataAtualizacao DateTime           @updatedAt
  equipe          equipes_de_venda   @relation(fields: [equipeId], references: [id], onDelete: Cascade)
  usuario         usracessos         @relation(fields: [usuarioId], references: [id], onDelete: Cascade)

  @@unique([equipeId, email])
  @@map("membros_equipe")
}

// Banners - Admin managed promotional banners for homepage
model banners {
  id              Int       @id @default(autoincrement())
  titulo          String    @db.VarChar(255)
  descricao       String?   @db.Text
  imagemUrl       String    @db.Text
  link            String?   @db.VarChar(500)
  ordem           Int       @default(0)
  ativo           Boolean   @default(true)
  dataCriacao     DateTime  @default(now())
  dataAtualizacao DateTime  @updatedAt

  @@map("banners")
}

// Fotos de Anuncio - Multiple images per ad (up to 5)
model fotos_anuncio {
  id                Int       @id @default(autoincrement())
  anuncio_id        Int
  url               String    @db.VarChar(500)
  ordem             Int       @default(1)
  criado_por        Int
  data_criacao      DateTime  @default(now())
  data_atualizacao  DateTime  @default(now())

  anuncio           anuncios  @relation(fields: [anuncio_id], references: [id], onDelete: Cascade)
  usuario           usracessos @relation(fields: [criado_por], references: [id], onDelete: Restrict)

  @@index([anuncio_id])
  @@index([anuncio_id, ordem])
}

// Listas de Desejos (Wishlists)
model listas_desejos {
  id                    Int                              @id @default(autoincrement())
  usuarioId             Int
  titulo                String                           @db.VarChar(255)
  descricao             String?
  status                String                           @default("privado") @db.VarChar(20)
  dataCriacao           DateTime                         @default(now())
  dataAtualizacao       DateTime                         @updatedAt

  usuario               usracessos                       @relation(fields: [usuarioId], references: [id], onDelete: Cascade)
  itens                 listas_desejos_itens[]
  permissoes            listas_desejos_permissoes[]

  @@index([usuarioId])
  @@index([status])
}

// Itens das Listas de Desejos
model listas_desejos_itens {
  id                    Int                    @id @default(autoincrement())
  listaId               Int
  tipo                  String                 @db.VarChar(50)
  titulo                String                 @db.VarChar(255)
  descricao             String?
  preco                 Decimal?               @db.Decimal(10, 2)
  imagem                String?                @db.VarChar(500)
  anuncioId             Int?
  dados_copiados        Json?
  dataCriacao           DateTime               @default(now())

  lista                 listas_desejos         @relation(fields: [listaId], references: [id], onDelete: Cascade)
  anuncio               anuncios?              @relation(fields: [anuncioId], references: [id], onDelete: SetNull)

  @@index([listaId])
  @@index([anuncioId])
}

// Permissões de Listas Privadas
model listas_desejos_permissoes {
  id                    Int                    @id @default(autoincrement())
  listaId               Int
  anuncianteId          Int
  dataCriacao           DateTime               @default(now())

  lista                 listas_desejos         @relation(fields: [listaId], references: [id], onDelete: Cascade)
  anunciante            anunciantes            @relation(fields: [anuncianteId], references: [id], onDelete: Cascade)

  @@unique([listaId, anuncianteId])
}

// Agendas para Aulas, Cursos e Serviços
model agendas {
  id                    Int                    @id @default(autoincrement())
  anuncioId             Int
  anuncianteId          Int
  titulo                String                 @db.VarChar(255)
  descricao             String?
  tipo                  String                 @db.VarChar(50)
  duracao_minutos       Int                    @default(60)
  preco                 Decimal?               @db.Decimal(10, 2)
  capacidade            Int                    @default(1)
  status                String                 @default("ativo") @db.VarChar(20)
  dataCriacao           DateTime               @default(now())
  dataAtualizacao       DateTime               @updatedAt

  anuncio               anuncios               @relation(fields: [anuncioId], references: [id], onDelete: Cascade)
  anunciante            anunciantes            @relation(fields: [anuncianteId], references: [id], onDelete: Cascade)
  slots                 slots_agenda[]
  reservas              reservas_agenda[]
  lista_espera          lista_espera_agenda[]

  @@index([anuncioId])
  @@index([anuncianteId])
  @@index([status])
}

// Links de Produtos Externos (Mercado Livre, Shopee, etc)
model links_produtos_externos {
  id                    Int                    @id @default(autoincrement())
  anuncianteId          Int
  productId             Int?
  marketplace           String                 @db.VarChar(50)
  url                   String                 @db.VarChar(500)
  preco                 Decimal?               @db.Decimal(10, 2)
  titulo_externo        String?                @db.VarChar(255)
  descricao_externa     String?
  status                String                 @default("ativo") @db.VarChar(20)
  dataCriacao           DateTime               @default(now())
  dataAtualizacao       DateTime               @updatedAt

  anunciante            anunciantes            @relation(fields: [anuncianteId], references: [id], onDelete: Cascade)
  product               productos?             @relation(fields: [productId], references: [id], onDelete: SetNull)

  @@index([anuncianteId])
  @@index([productId])
  @@index([marketplace])
  @@index([status])
}

// Slots de Agenda (Horários Disponíveis)
model slots_agenda {
  id                    Int                    @id @default(autoincrement())
  agendaId              Int
  data_hora_inicio      DateTime
  data_hora_fim         DateTime
  vagas_disponiveis     Int
  vagas_preenchidas     Int                    @default(0)
  status                String                 @default("disponivel") @db.VarChar(20)
  dataCriacao           DateTime               @default(now())

  agenda                agendas                @relation(fields: [agendaId], references: [id], onDelete: Cascade)
  reservas              reservas_agenda[]

  @@index([agendaId])
  @@index([data_hora_inicio])
  @@index([status])
}

// Reservas de Agenda
model reservas_agenda {
  id                    Int                    @id @default(autoincrement())
  slotId                Int
  usuarioId             Int
  agendaId              Int
  status                String                 @default("confirmado") @db.VarChar(20)
  data_confirmacao      DateTime               @default(now())
  dataCriacao           DateTime               @default(now())

  slot                  slots_agenda           @relation(fields: [slotId], references: [id], onDelete: Cascade)
  usuario               usracessos             @relation(fields: [usuarioId], references: [id], onDelete: Cascade)
  agenda                agendas                @relation(fields: [agendaId], references: [id], onDelete: Cascade)

  @@unique([slotId, usuarioId])
  @@index([slotId])
  @@index([usuarioId])
  @@index([agendaId])
  @@index([status])
}

// Lista de Espera para Agendas
model lista_espera_agenda {
  id                    Int                    @id @default(autoincrement())
  agendaId              Int
  usuarioId             Int
  data_horario_desejada DateTime?
  posicao               Int
  status                String                 @default("aguardando") @db.VarChar(20)
  motivo_cancelamento   String?
  dataCriacao           DateTime               @default(now())

  agenda                agendas                @relation(fields: [agendaId], references: [id], onDelete: Cascade)
  usuario               usracessos             @relation(fields: [usuarioId], references: [id], onDelete: Cascade)

  @@unique([agendaId, usuarioId])
  @@index([agendaId])
  @@index([usuarioId])
  @@index([status])
}

// Eventos de Agenda do Anunciante (Compromissos, Horários, etc)
model eventos_agenda_anunciante {
  id                    Int                              @id @default(autoincrement())
  anuncianteId          Int
  titulo                String                           @db.VarChar(255)
  descricao             String?
  dataInicio            DateTime
  dataFim               DateTime
  privacidade           String                           @default("privado") @db.VarChar(20) // "publico", "privado_usuarios", "privado"
  cor                   String?                          @default("#3B82F6") @db.VarChar(7)
  status                String                           @default("pendente") @db.VarChar(30) // "pendente", "realizado", "pendente_pagamento", "substituicao"
  dataCriacao           DateTime                         @default(now())
  dataAtualizacao       DateTime                         @updatedAt

  anunciante            anunciantes                      @relation(fields: [anuncianteId], references: [id], onDelete: Cascade)
  permissoes            eventos_agenda_permissoes[]
  reservas              reservas_evento_agenda[]
  filasEspera           filas_espera_agenda[]

  @@index([anuncianteId])
  @@index([dataInicio])
  @@index([privacidade])
  @@index([status])
}

// Permissões para Eventos Privados com Usuários Específicos
model eventos_agenda_permissoes {
  id                    Int                              @id @default(autoincrement())
  eventoId              Int
  usuarioId             Int
  dataCriacao           DateTime                         @default(now())

  evento                eventos_agenda_anunciante        @relation(fields: [eventoId], references: [id], onDelete: Cascade)
  usuario               usracessos                       @relation(fields: [usuarioId], references: [id], onDelete: Cascade)

  @@unique([eventoId, usuarioId])
  @@index([eventoId])
  @@index([usuarioId])
}

// Reservas de Eventos da Agenda
model reservas_evento_agenda {
  id                    Int                              @id @default(autoincrement())
  eventoId              Int
  usuarioId             Int?                             // Pode ser null se for lista de espera de não-logado
  emailSolicitante      String?                          @db.VarChar(255)
  nomeSolicitante       String?                          @db.VarChar(255)
  telefoneSolicitante   String?                          @db.VarChar(20)
  tipo                  String                           @default("reserva") @db.VarChar(20) // "reserva" ou "lista_espera"
  status                String                           @default("pendente") @db.VarChar(20) // "pendente", "confirmada", "rejeitada", "cancelada"
  posicaoListaEspera    Int?                             // Posição na fila (para lista de espera)
  motivo                String?                          // Motivo da rejeição
  dataSolicitacao       DateTime                         @default(now())
  dataConfirmacao       DateTime?
  dataCancelamento      DateTime?
  dataCriacao           DateTime                         @default(now())
  dataAtualizacao       DateTime                         @updatedAt

  evento                eventos_agenda_anunciante        @relation(fields: [eventoId], references: [id], onDelete: Cascade)
  usuario               usracessos?                      @relation(fields: [usuarioId], references: [id], onDelete: SetNull)

  @@index([eventoId])
  @@index([usuarioId])
  @@index([status])
  @@index([tipo])
}

// Conversas (Chat Conversations)
model conversas {
  id                  Int         @id @default(autoincrement())
  usuarioId           Int         @map("usuarioid")
  anuncianteId        Int         @map("anuncianteid")
  anuncioId           Int?        @map("anuncioid")
  assunto             String      @db.VarChar(255)
  tipo                String      @default("privada") @db.VarChar(50) // "privada" ou "publica"
  dataCriacao         DateTime    @default(now()) @map("datacriacao")
  dataAtualizacao     DateTime    @updatedAt @map("dataatualizacao")

  usuario             usracessos  @relation(fields: [usuarioId], references: [id], onDelete: Cascade)
  anunciante          anunciantes @relation(fields: [anuncianteId], references: [id], onDelete: Cascade)
  anuncio             anuncios?   @relation(fields: [anuncioId], references: [id], onDelete: SetNull)
  mensagens           mensagens[]

  @@index([usuarioId])
  @@index([anuncianteId])
  @@index([anuncioId])
  @@index([dataCriacao])
  @@map("conversas")
}

// Mensagens (Messages)
model mensagens {
  id                  Int       @id @default(autoincrement())
  conversaId          Int       @map("conversaid")
  usuarioId           Int?      @map("usuarioid")
  anuncianteId        Int?      @map("anuncianteid")
  conteudo            String    @db.Text
  status              String    @default("nao_lida") @db.VarChar(50) // "nao_lida", "lida", "entregue"
  excluido            Boolean   @default(false) // Soft delete flag
  dataCriacao         DateTime  @default(now()) @map("datacriacao")
  dataAtualizacao     DateTime  @updatedAt @map("dataatualizacao")

  conversa            conversas @relation(fields: [conversaId], references: [id], onDelete: Cascade)
  usuario             usracessos? @relation(fields: [usuarioId], references: [id], onDelete: SetNull)
  anunciante          anunciantes? @relation(fields: [anuncianteId], references: [id], onDelete: SetNull)

  @@index([conversaId])
  @@index([usuarioId])
  @@index([anuncianteId])
  @@index([dataCriacao])
  @@index([excluido])
  @@map("mensagens")
}

// Pagamentos de Anúncios
model pagamentos {
  id                    Int       @id @default(autoincrement())
  anuncioId             Int       @unique
  anuncio               anuncios  @relation(fields: [anuncioId], references: [id], onDelete: Cascade)

  valor                 Decimal   @db.Decimal(10, 2)
  status                String    @default("pendente") @db.VarChar(50) // pendente, comprovante_enviado, aprovado, rejeitado
  tipo                  String    @default("pix") @db.VarChar(50)

  // Comprovante
  comprovantePagamento  String?   @db.VarChar(500) // URL do comprovante (storage)
  dataComprovante       DateTime?

  // Controle
  dataCriacao           DateTime  @default(now())
  dataAtualizacao       DateTime  @updatedAt

  @@index([anuncioId])
  @@index([status])
  @@index([dataCriacao])
  @@map("pagamentos")
}

// Filas de Espera para Eventos de Agenda (Waiting Queues)
model filas_espera_agenda {
  id                      Int                               @id @default(autoincrement())
  eventoId                Int                               @db.Integer
  usuarioSolicitanteId    Int
  anuncianteAlvoId        Int  // Anunciante cuja agenda está recebendo a solicitação
  titulo                  String                            @db.VarChar(255)
  descricao               String?
  dataInicio              DateTime
  dataFim                 DateTime
  status                  String                            @default("pendente") @db.VarChar(30) // "pendente", "aprovada", "rejeitada", "cancelada"
  motivo_rejeicao         String?  // Motivo da rejeição
  dataSugestao            DateTime?  // Data sugerida pelo dono da agenda para resubmissão
  horaSugestao            String?  @db.VarChar(5)  // Hora sugerida (HH:mm)
  dataSolicitacao         DateTime                          @default(now())
  dataResposta            DateTime?
  dataCriacao             DateTime                          @default(now())
  dataAtualizacao         DateTime                          @updatedAt

  evento                  eventos_agenda_anunciante         @relation(fields: [eventoId], references: [id], onDelete: Cascade)
  usuarioSolicitante      usracessos                        @relation("fila_espera_usuario", fields: [usuarioSolicitanteId], references: [id], onDelete: Cascade)
  anuncianteAlvo          anunciantes                       @relation("filas_espera_anunciante", fields: [anuncianteAlvoId], references: [id], onDelete: Cascade)

  @@index([eventoId])
  @@index([usuarioSolicitanteId])
  @@index([anuncianteAlvoId])
  @@index([status])
  @@index([dataSolicitacao])
}

// Localidades/Localities for geographic filtering
model localidades {
  id                           Int                             @id @default(autoincrement())
  codigo                       String                          @unique @db.VarChar(50)
  municipio                    String                          @db.VarChar(255)
  estado                       String                          @db.VarChar(2)
  descricao                    String?
  observacao                   String?
  status                       String                          @default("ativo") @db.VarChar(20) // "ativo" ou "inativo"
  dataCriacao                  DateTime                        @default(now())
  dataAtualizacao              DateTime                        @updatedAt

  usuarios_padrao              usracessos[]
  anunciantes                  anunciantes_x_localidades[]

  @@index([status])
  @@index([municipio])
  @@index([estado])
  @@unique([municipio, estado])
}

// Junction table: Anunciantes x Localidades (M:N)
model anunciantes_x_localidades {
  id                Int         @id @default(autoincrement())
  anuncianteId      Int
  localidadeId      Int
  dataCriacao       DateTime    @default(now())

  anunciante        anunciantes @relation(fields: [anuncianteId], references: [id], onDelete: Cascade)
  localidade        localidades @relation(fields: [localidadeId], references: [id], onDelete: Cascade)

  @@unique([anuncianteId, localidadeId])
  @@index([anuncianteId])
  @@index([localidadeId])
}
